<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Loja Val - Vendas</title>

<style>
    body {
        font-family: Arial;
        margin: 20px;
    }
    h2 { margin-top: 0; }

    /* GRID DE 2 COLUNAS */
    .row {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
    }
    .col-50 {
        width: calc(50% - 10px);
        min-width: 250px;
    }
    .col-100 {
        width: 100%;
    }

    input, select, button {
        padding: 8px;
        margin: 6px 0;
        width: 100%;
        box-sizing: border-box;
        font-size: 15px;
    }
    .btn {
        background: #ffcc00;
        border: none;
        cursor: pointer;
        font-size: 16px;
        padding: 10px;
        border-radius: 6px;
        margin-top: 10px;
    }
    .btn:hover { background: #e6b800; }

    .box {
        border: 1px solid #ccc;
        padding: 15px;
        border-radius: 6px;
        margin-bottom: 20px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
    }
    th, td {
        border: 1px solid #999;
        padding: 8px;
        text-align: left;
    }
    th { background: #eee; }

    .totalFinal {
        font-size: 22px;
        font-weight: bold;
        text-align: right;
        margin-top: 20px;
    }
</style>
</head>

<body>

<h2>Nova Venda</h2>

<button onclick="window.location.href='index.html'">⬅ Voltar</button>

<div class="box">
    <h3>Informações da Venda</h3>

    <div class="row">
        <div class="col-50">
            <label>Data da venda</label>
            <input type="date" id="dataVenda">
        </div>

        <div class="col-50">
            <label>Nome do cliente (opcional)</label>
            <input type="text" id="cliente" placeholder="Ex: João Pedro">
        </div>
    </div>
</div>

<div class="box">
    <h3>Adicionar Produto</h3>

    <div class="row">
        <div class="col-50">
            <label>Código do produto</label>
            <input type="text" id="codigoProd" placeholder="Código (obrigatório)">
        </div>

        <div class="col-50">
            <label>Quantidade</label>
            <input type="number" id="qtdProd" placeholder="Quantidade (obrigatório)">
        </div>

        <div class="col-50">
            <label>Produto</label>
            <input type="text" id="nomeProd" disabled placeholder="Nome do produto">
        </div>

        <div class="col-50">
            <label>Valor unitário</label>
            <input type="text" id="valorProd" disabled placeholder="Valor do produto">
        </div>
    </div>

    <button class="btn" onclick="adicionarProduto()">Adicionar produto</button>
</div>

<h3>Itens da Venda</h3>
<table id="tabelaItens">
    <thead>
        <tr>
            <th>Código</th>
            <th>Produto</th>
            <th>Qtd</th>
            <th>Valor</th>
            <th>Total</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<div class="totalFinal" id="valorFinal">Total da venda: R$ 0,00</div>

<div class="box">
    <h3>Método de Pagamento (obrigatório)</h3>

    <select id="pagamento">
        <option value="">Selecione...</option>
        <option value="pix">PIX</option>
        <option value="debito">Débito</option>
        <option value="credito">Crédito</option>
        <option value="dinheiro">Dinheiro</option>
        <option value="prazo">A prazo</option>
    </select>

    <button class="btn" onclick="finalizarVenda()">Finalizar venda</button>
</div>

<script>
/* --- NÃO ALTEREI NADA DO JS --- */
/* Se quiser integrar ao estoque depois, também faço. */

const produtos = [
    { codigo: "0001", nome: "Perfume", valor: 22.00 },
    { codigo: "0002", nome: "Creme", valor: 7.50 },
    { codigo: "0003", nome: "Shampoo", valor: 4.00 },
    { codigo: "0004", nome: "Óleo Corporal", valor: 8.80 }
];

document.getElementById("codigoProd").addEventListener("input", function () {
    const p = produtos.find(x => x.codigo === this.value);
    document.getElementById("nomeProd").value = p ? p.nome : "";
    document.getElementById("valorProd").value = p ? p.valor.toFixed(2) : "";
});

let itensVenda = [];

function adicionarProduto() {
    const cod = document.getElementById("codigoProd").value;
    const qtd = parseInt(document.getElementById("qtdProd").value);
    const prod = produtos.find(x => x.codigo === cod);

    if (!prod) return alert("Código de produto inválido!");
    if (!qtd || qtd <= 0) return alert("Quantidade inválida!");

    itensVenda.push({
        codigo: prod.codigo,
        nome: prod.nome,
        qtd,
        valor: prod.valor,
        total: prod.valor * qtd
    });

    atualizarTabela();
    limparCamposProduto();
}

function atualizarTabela() {
    const tbody = document.querySelector("#tabelaItens tbody");
    tbody.innerHTML = "";

    let totalFinal = 0;

    itensVenda.forEach(item => {
        tbody.innerHTML += `
            <tr>
                <td>${item.codigo}</td>
                <td>${item.nome}</td>
                <td>${item.qtd}</td>
                <td>R$ ${item.valor.toFixed(2)}</td>
                <td>R$ ${item.total.toFixed(2)}</td>
            </tr>`;
        totalFinal += item.total;
    });

    document.getElementById("valorFinal").textContent =
        "Total da venda: R$ " + totalFinal.toFixed(2);
}

function limparCamposProduto() {
    codigoProd.value = "";
    nomeProd.value = "";
    valorProd.value = "";
    qtdProd.value = "";
}

function finalizarVenda() {
    if (itensVenda.length === 0) return alert("Adicione pelo menos um produto!");
    if (!pagamento.value) return alert("Selecione um método de pagamento!");

    alert("Venda finalizada com sucesso!");
}
</script>

</body>
</html>
